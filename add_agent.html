

<title>Add Agent</title>
<meta charset="utf-8">
<script src="http://code.jquery.com/jquery-2.1.1.min.js"></script>

<div style="height:1050px;width:550px;margin:50px auto;margin-left:auto;border:solid 1px;background: rgb(246, 246, 253);">
　　<div style="margin-left: 45px;">
    　　<h1>Adding agents</h1>
        <h2>Agent information</h2>
　　　　<form action="#" role="form" method="post">
            <h4>Firstname</h4>
            <input type="text" id="firstname" name="firstname" />
            <h4>Lastname</h4>
            <input type="text" id="lastname" name="lastname" />
            <h4>Email address</h4>
            <input type="text" id="email" name="email" onkeyup=""/>
            <h4>Password</h4>
            <p>Password length must be between 8 and 64 characters, contain at least 1 lowercase, 1 uppercase, 1 number and 1 special character</p>
            <input type="password" id="password" name="password" />
            <h4>Confirm password</h4>
            <input type="password" id="confirm_password" name="confirm_password" />
            <h4>Languages</h4>
            <p>
                <input type="checkbox" id="chinese">
                <label for="chinese">Chinese</label>
            </p>
            <p>
                <input type="checkbox" id="english">
                <label for="english">English</label>
            </p>
            <p>
                <input type="checkbox" id="malay">
                <label for="malay">Malay</label>
            </p>
            <h4>Skills</h4>
            <p>
                <input type="checkbox" id="skill1">
                <label for="skill1">Insurance</label>
            </p>
            <p>
                <input type="checkbox" id="skill2">
                <label for="skill2">Fraud</label>
            </p>
            <p>
                <input type="checkbox" id="skill3">
                <label for="skill3">Bank Statement</label>
            </p>
            <div style="margin-top:30px;margin-left:125px;">
    　　　　　　 <input type="button" onclick="add_agent();" value="Add">
                <input type="button" onclick="location.href='/home';" value="Go Back to Home" />  
　　　　　　</div>
        </form>
　　</div>
</div>

<script> function add_agent(){
    console.log("adding agent");
    var firstname = $('#firstname').val();
    var lastname = $('#lastname').val();
    var email = $('#email').val();
    var password = $('#password').val();
    var confirm_password = $('#confirm_password').val();
    var chinese = 0;
    var english = 0;
    var malay = 0;
    var skill1 = 0;
    var skill2 = 0;
    var skill3 = 0;

    if (firstname == "" || lastname == ""){
        console.log("empty name");
        alert("Please enter your name");
        return;
    }

    var email_pattern = /^([A-Za-z0-9_\-\.])+\@([A-Za-z0-9_\-\.])+\.([A-Za-z]{2,4})$/
    if(email_pattern.test(email) != true){
        console.log("invalid email");
        alert("Please enter a valid email");
        return;
    }

    var password_pattern = /^.*(?=.{8,64})(?=.*\d)(?=.*[A-Z])(?=.*[a-z])(?=.*[!@#$%^&*? ]).*$/;
    if(password_pattern.test(password) != true){
        alert("Please enter a valid password");
        return;
    }

    if(password != confirm_password){
        alert("Password and confirm password are different, please check again");
        return;
    }


    if($("#chinese").is(':checked')){
        chinese = 1;
    }
    if($("#english").is(':checked')){
        english = 1;
    }
    if($("#malay").is(':checked')){
        malay = 1;
    }
    if($("#skill1").is(':checked')){
        skill1 = 1;
    }
    if($("#skill2").is(':checked')){
        skill2 = 1;
    }
    if($("#skill3").is(':checked')){
        skill3 = 1;
    }

    var data = {"firstname": firstname, 
                "lastname": lastname, 
                "password":password, 
                "email": email,
                "chinese": chinese,
                "english": english,
                "malay": malay,
                "skill1": skill1,
                "skill2": skill2,
                "skill3": skill3
            };
    $.ajax({
        url:'add_agent',
        type:'POST',
        data:data,
        success:function(data,status){
            if(status == 'success'){
                alert("Agent added successfully!")
                location.href='home';
            }
        },
        error:function(data,status,e){
            if(status == "error"){
                alert("Adding agent failed, please try again.")
                location.href='add_agent';
                }
            }
        });
    }
</script>
 